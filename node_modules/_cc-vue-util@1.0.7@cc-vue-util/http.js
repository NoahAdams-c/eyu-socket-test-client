/**
 * @Description:
 * @Author: chenchen
 * @Date: 2019-08-30 10:59:45
 * @LastEditors: chenchen
 * @LastEditTime: 2019-11-18 12:56:07
 */
let axios = require("axios")

module.exports = (host, timeout = 20000) => {
	axios.defaults.timeout = timeout
	axios.defaults.baseURL = host

	axios.interceptors.request.use(
		config => {
			config.url = config.baseURL + config.url
			return config
		},
		err => {
			return Promise.reject(err)
		}
	)

	let obj = {}

	obj.doGet = (url, params = {}, options = {}) => {
		return new Promise((resolve, reject) => {
			axios
				.get(url, Object.assign({ params: params }, options))
				.then(resp => {
					resolve(resp.data)
				})
				.catch(err => {
					reject(err)
				})
		})
	}

	obj.doPost = (url, data = {}, options = {}) => {
		return new Promise((resolve, reject) => {
			axios.post(url, data, options).then(
				resp => {
					resolve(resp.data)
				},
				err => {
					reject(err)
				}
			)
		})
	}

	return obj
}
